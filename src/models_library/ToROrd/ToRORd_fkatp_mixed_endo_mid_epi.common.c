//celltype = 2;
real nao = 140.0;
real cao = 1.8;
real ko = 5.0;
real clo = 150.0;
real R = 8314;
real T = 310;
real F = 96485;
real zna = 1;
real zca = 2;
real zk = 1;
real zcl = -1;
real L = 0.01;
real rad = 0.0011;
real KmCaMK = 0.15;
real aCaMK = 0.05;
real bCaMK = 0.00068;
real CaMKo = 0.05;
real KmCaM = 0.0015;
real cmdnmax_b = 0.05;
real kmcmdn = 0.00238;
real trpnmax = 0.07;
real kmtrpn = 0.0005;
real BSRmax = 0.047;
real KmBSR = 0.00087;
real BSLmax = 1.124;
real KmBSL = 0.0087;
real csqnmax = 10;
real kmcsqn = 0.8;
real cli = 24.0;
real PKNa = 0.01833;
real gkatp = 4.3195;
real fkatp = 0.0;
real K_o_n = 5;
real A_atp = 2;
real K_atp = 0.25;
real GNa = 11.7802;
real thL = 200;
real GNaL_b = 0.0279;
real Gto_b = 0.16;
real EKshift = 0;
real Kmn = 0.002;
real k2n = 500;
real PCa_b = 8.3757e-05;
real Aff = 0.6;
real tjca = 75;
real vShift = 0;
real offset = 0;
real dielConstant = 74;
real ICaL_fractionSS = 0.8;
real GKr_b = 0.0321;
real alpha_1 = 0.154375;
real beta_1 = 0.1911;
real GKs_b = 0.0011;
real GK1_b = 0.6992;
real INaCa_fractionSS = 0.35;
real kna1 = 15;
real kna2 = 5;
real kna3 = 88.12;
real kasymm = 12.5;
real wna = 6e4;
real wca = 6e4;
real wnaca = 5e3;
real kcaon = 1.5e6;
real kcaoff = 5e3;
real qna = 0.5224;
real qca = 0.167;
real KmCaAct = 150e-6;
real Gncx_b = 0.0034;
real k1p = 949.5;
real k1m = 182.4;
real k2p = 687.2;
real k2m = 39.4;
real k3p = 1899;
real k3m = 79300;
real k4p = 639;
real k4m = 40;
real Knai0 = 9.073;
real Knao0 = 27.78;
real delta = -0.155;
real Kki = 0.5;
real Kko = 0.3582;
real MgADP = 0.05;
real MgATP = 9.8;
real Kmgatp = 1.698e-7;
real H = 1e-7;
real eP = 4.2;
real Khp = 1.698e-7;
real Knap = 224;
real Kxkur = 292;
real Pnak_b = 15.4509;
real GKb_b = 0.0189;
real PNab = 1.9239e-09;
real PCab = 5.9194e-08;
real GpCa = 5e-04;
real KmCap = 0.0005;
real GClCa = 0.2843;
real GClb = 1.98e-3;
real KdClCa = 0.1;
real Fjunc = 1;
real tauNa = 2.0;
real tauK = 2.0;
real tauCa = 0.2;
real bt = 4.75;
real cajsr_half = 1.7;
real Jrel_b = 1.5378;
real Jup_b = 1.0;
real vcell =  1000.00*3.14000*rad*rad*L;
real cmdnmax = (celltype==EPI ?  cmdnmax_b*1.30000 : cmdnmax_b);
real ECl =  (( R*T)/( zcl*F))*log(clo/cli);
real akik = pow(ko/K_o_n, 0.240000);
real bkik = 1.00000/(1.00000+pow(A_atp/K_atp, 2.00000));
real thLp =  3.00000*thL;
real GNaL = (celltype==EPI ?  GNaL_b*0.600000 : GNaL_b);
real Gto = (celltype==EPI ?  Gto_b*2.00000 : celltype==MID ?  Gto_b*2.00000 : Gto_b);
real Afs = 1.00000 - Aff;
real PCa = (celltype==EPI ?  PCa_b*1.20000 : celltype==MID ?  PCa_b*2.00000 : PCa_b);
real Io = ( 0.500000*(nao+ko+clo+ 4.00000*cao))/1000.00;
real GKr = (celltype==EPI ?  GKr_b*1.30000 : celltype==MID ?  GKr_b*0.800000 : GKr_b);
real GKs = (celltype==EPI ?  GKs_b*1.40000 : GKs_b);
real GK1 = (celltype==EPI ?  GK1_b*1.20000 : celltype==MID ?  GK1_b*1.30000 : GK1_b);
real GKb = (celltype==EPI ?  GKb_b*0.600000 : GKb_b);
real a_rel = ( 0.500000*bt)/1.00000;
real btp =  1.25000*bt;
real upScale = (celltype==EPI ? 1.30000 : 1.00000);
real Ageo =  2.00000*3.14000*rad*rad+ 2.00000*3.14000*rad*L;
real PCap =  1.10000*PCa;
real PCaNa =  0.00125000*PCa;
real PCaK =  0.000357400*PCa;
real constA =  1.82000e+06*pow( dielConstant*T, - 1.50000);
real a_relp = ( 0.500000*btp)/1.00000;
real Acap =  2.00000*Ageo;
real PCaNap =  0.00125000*PCap;
real PCaKp =  0.000357400*PCap;
real gamma_cao = exp( - constA*4.00000*( pow(Io, 1.0 / 2)/(1.00000+ pow(Io, 1.0 / 2)) -  0.300000*Io));
real gamma_nao = exp( - constA*1.00000*( pow(Io, 1.0 / 2)/(1.00000+ pow(Io, 1.0 / 2)) -  0.300000*Io));
real gamma_ko = exp( - constA*1.00000*( pow(Io, 1.0 / 2)/(1.00000+ pow(Io, 1.0 / 2)) -  0.300000*Io));
real vmyo =  0.680000*vcell;
real vnsr =  0.0552000*vcell;
real vjsr =  0.00480000*vcell;
real vss =  0.0200000*vcell;
real h10_i = kasymm+1.00000+ (nao/kna1)*(1.00000+nao/kna2);
real h11_i = ( nao*nao)/( h10_i*kna1*kna2);
real h12_i = 1.00000/h10_i;
real k1_i =  h12_i*cao*kcaon;
real k2_i = kcaoff;
real k5_i = kcaoff;
real Gncx = (celltype==EPI ?  Gncx_b*1.10000 : celltype==MID ?  Gncx_b*1.40000 : Gncx_b);
real h10_ss = kasymm+1.00000+ (nao/kna1)*(1.00000+nao/kna2);
real h11_ss = ( nao*nao)/( h10_ss*kna1*kna2);
real h12_ss = 1.00000/h10_ss;
real k1_ss =  h12_ss*cao*kcaon;
real k2_ss = kcaoff;
real k5_ss = kcaoff;
real b1 =  k1m*MgADP;
real a2 = k2p;
real a4 = (( k4p*MgATP)/Kmgatp)/(1.00000+MgATP/Kmgatp);
real Pnak = (celltype==EPI ?  Pnak_b*0.900000 : celltype==MID ?  Pnak_b*0.700000 : Pnak_b);
real hLss = 1.00000/(1.00000+exp((STATES[0]+87.6100)/7.48800));
real hLssp = 1.00000/(1.00000+exp((STATES[0]+93.8100)/7.48800));
real jcass = 1.00000/(1.00000+exp((STATES[0]+18.0800)/2.79160));
real mss = 1.00000/pow(1.00000+exp(- (STATES[0]+56.8600)/9.03000), 2.00000);
real tm =  0.129200*exp(- pow((STATES[0]+45.7900)/15.5400, 2.00000))+ 0.0648700*exp(- pow((STATES[0] - 4.82300)/51.1200, 2.00000));
real mLss = 1.00000/(1.00000+exp(- (STATES[0]+42.8500)/5.26400));
real tmL =  0.129200*exp(- pow((STATES[0]+45.7900)/15.5400, 2.00000))+ 0.0648700*exp(- pow((STATES[0] - 4.82300)/51.1200, 2.00000));
real ass = 1.00000/(1.00000+exp(- ((STATES[0]+EKshift) - 14.3400)/14.8200));
real ta = 1.05150/(1.00000/( 1.20890*(1.00000+exp(- ((STATES[0]+EKshift) - 18.4099)/29.3814)))+3.50000/(1.00000+exp((STATES[0]+EKshift+100.000)/29.3814)));
real dss = (STATES[0]>=31.4978 ? 1.00000 :  1.07630*exp( - 1.00700*exp( - 0.0829000*STATES[0])));
real td = offset+0.600000+1.00000/(exp( - 0.0500000*(STATES[0]+vShift+6.00000))+exp( 0.0900000*(STATES[0]+vShift+14.0000)));
real fss = 1.00000/(1.00000+exp((STATES[0]+19.5800)/3.69600));
real tff = 7.00000+1.00000/( 0.00450000*exp(- (STATES[0]+20.0000)/10.0000)+ 0.00450000*exp((STATES[0]+20.0000)/10.0000));
real tfs = 1000.00+1.00000/( 3.50000e-05*exp(- (STATES[0]+5.00000)/4.00000)+ 3.50000e-05*exp((STATES[0]+5.00000)/6.00000));
real km2n =  STATES[29]*1.00000;
real anca = 1.00000/(k2n/km2n+pow(1.00000+Kmn/STATES[2], 4.00000));
real anca_i = 1.00000/(k2n/km2n+pow(1.00000+Kmn/STATES[9], 4.00000));
real xs1ss = 1.00000/(1.00000+exp(- (STATES[0]+11.6000)/8.93200));
real txs1 = 817.300+1.00000/( 0.000232600*exp((STATES[0]+48.2800)/17.8000)+ 0.00129200*exp(- (STATES[0]+210.000)/230.000));
real assp = 1.00000/(1.00000+exp(- ((STATES[0]+EKshift) - 24.3400)/14.8200));
real fcass = fss;
real tfcaf = 7.00000+1.00000/( 0.0400000*exp(- (STATES[0] - 4.00000)/7.00000)+ 0.0400000*exp((STATES[0] - 4.00000)/7.00000));
real tfcas = 100.000+1.00000/( 0.000120000*exp(- STATES[0]/3.00000)+ 0.000120000*exp(STATES[0]/7.00000));
real tffp =  2.50000*tff;
real xs2ss = xs1ss;
real txs2 = 1.00000/( 0.0100000*exp((STATES[0] - 50.0000)/20.0000)+ 0.0193000*exp(- (STATES[0]+66.5400)/31.0000));
real CaMKb = ( CaMKo*(1.00000 - STATES[1]))/(1.00000+KmCaM/STATES[2]);
real hss = 1.00000/pow(1.00000+exp((STATES[0]+71.5500)/7.43000), 2.00000);
real ah = (STATES[0]>=- 40.0000 ? 0.00000 :  0.0570000*exp(- (STATES[0]+80.0000)/6.80000));
real bh = (STATES[0]>=- 40.0000 ? 0.770000/( 0.130000*(1.00000+exp(- (STATES[0]+10.6600)/11.1000))) :  2.70000*exp( 0.0790000*STATES[0])+ 310000.*exp( 0.348500*STATES[0]));
real th = 1.00000/(ah+bh);
real tfcafp =  2.50000*tfcaf;
real jss = hss;
real aj = (STATES[0]>=- 40.0000 ? 0.00000 : ( ( - 25428.0*exp( 0.244400*STATES[0]) -  6.94800e-06*exp( - 0.0439100*STATES[0]))*(STATES[0]+37.7800))/(1.00000+exp( 0.311000*(STATES[0]+79.2300))));
real bj = (STATES[0]>=- 40.0000 ? ( 0.600000*exp( 0.0570000*STATES[0]))/(1.00000+exp( - 0.100000*(STATES[0]+32.0000))) : ( 0.0242400*exp( - 0.0105200*STATES[0]))/(1.00000+exp( - 0.137800*(STATES[0]+40.1400))));
real tj = 1.00000/(aj+bj);
real hssp = 1.00000/pow(1.00000+exp((STATES[0]+77.5500)/7.43000), 2.00000);
real iss = 1.00000/(1.00000+exp((STATES[0]+EKshift+43.9400)/5.71100));
real delta_epi = (celltype==EPI ? 1.00000 - 0.950000/(1.00000+exp((STATES[0]+EKshift+70.0000)/5.00000)) : 1.00000);
real tiF_b = 4.56200+1.00000/( 0.393300*exp(- (STATES[0]+EKshift+100.000)/100.000)+ 0.0800400*exp((STATES[0]+EKshift+50.0000)/16.5900));
real tiF =  tiF_b*delta_epi;
real vfrt = ( STATES[0]*F)/( R*T);
real alpha =  0.116100*exp( 0.299000*vfrt);
real beta =  0.244200*exp( - 1.60400*vfrt);
real tjp =  1.46000*tj;
real tiS_b = 23.6200+1.00000/( 0.00141600*exp(- (STATES[0]+EKshift+96.5200)/59.0500)+ 1.78000e-08*exp((STATES[0]+EKshift+114.100)/8.07900));
real tiS =  tiS_b*delta_epi;
real alpha_2 =  0.0578000*exp( 0.971000*vfrt);
real beta_2 =  0.000349000*exp( - 1.06200*vfrt);
real alpha_i =  0.253300*exp( 0.595300*vfrt);
real beta_i =  0.0652500*exp( - 0.820900*vfrt);
real dti_develop = 1.35400+0.000100000/(exp(((STATES[0]+EKshift) - 167.400)/15.8900)+exp(- ((STATES[0]+EKshift) - 12.2300)/0.215400));
real dti_recover = 1.00000 - 0.500000/(1.00000+exp((STATES[0]+EKshift+70.0000)/20.0000));
real tiFp =  dti_develop*dti_recover*tiF;
real tiSp =  dti_develop*dti_recover*tiS;
real alpha_C2ToI =  5.20000e-05*exp( 1.52500*vfrt);
real beta_ItoC2 = ( beta_2*beta_i*alpha_C2ToI)/( alpha_2*alpha_i);
real f =  Aff*STATES[25]+ Afs*STATES[26];
real Afcaf = 0.300000+0.600000/(1.00000+exp((STATES[0] - 10.0000)/10.0000));
real Afcas = 1.00000 - Afcaf;
real fca =  Afcaf*STATES[27]+ Afcas*STATES[28];
real fp =  Aff*STATES[30]+ Afs*STATES[26];
real fcap =  Afcaf*STATES[31]+ Afcas*STATES[28];
real vffrt = ( STATES[0]*F*F)/( R*T);
real Iss = ( 0.500000*(STATES[4]+STATES[6]+cli+ 4.00000*STATES[2]))/1000.00;
real gamma_cass = exp( - constA*4.00000*( pow(Iss, 1.0 / 2)/(1.00000+ pow(Iss, 1.0 / 2)) -  0.300000*Iss));
real PhiCaL_ss = ( 4.00000*vffrt*( gamma_cass*STATES[2]*exp( 2.00000*vfrt) -  gamma_cao*cao))/(exp( 2.00000*vfrt) - 1.00000);
real CaMKa = CaMKb+STATES[1];
real fICaLp = 1.00000/(1.00000+KmCaMK/CaMKa);
real ICaL_ss =  ICaL_fractionSS*( (1.00000 - fICaLp)*PCa*PhiCaL_ss*STATES[24]*( f*(1.00000 - STATES[32])+ STATES[29]*fca*STATES[32])+ fICaLp*PCap*PhiCaL_ss*STATES[24]*( fp*(1.00000 - STATES[32])+ STATES[29]*fcap*STATES[32]));
real Jrel_inf_b = (( - a_rel*ICaL_ss)/1.00000)/(1.00000+pow(cajsr_half/STATES[8], 8.00000));
real Jrel_inf = (celltype==MID ?  Jrel_inf_b*1.70000 : Jrel_inf_b);
real tau_rel_b = bt/(1.00000+0.0123000/STATES[8]);
real tau_rel = (tau_rel_b<0.00100000 ? 0.00100000 : tau_rel_b);
real Jrel_infp_b = (( - a_relp*ICaL_ss)/1.00000)/(1.00000+pow(cajsr_half/STATES[8], 8.00000));
real Jrel_infp = (celltype==MID ?  Jrel_infp_b*1.70000 : Jrel_infp_b);
real tau_relp_b = btp/(1.00000+0.0123000/STATES[8]);
real tau_relp = (tau_relp_b<0.00100000 ? 0.00100000 : tau_relp_b);
real EK =  (( R*T)/( zk*F))*log(ko/STATES[5]);
real AiF = 1.00000/(1.00000+exp(((STATES[0]+EKshift) - 213.600)/151.200));
real AiS = 1.00000 - AiF;
real i =  AiF*STATES[19]+ AiS*STATES[20];
real ip =  AiF*STATES[22]+ AiS*STATES[23];
real fItop = 1.00000/(1.00000+KmCaMK/CaMKa);
real Ito =  Gto*(STATES[0] - EK)*( (1.00000 - fItop)*STATES[18]*i+ fItop*STATES[21]*ip);
real IKr =  GKr* pow((ko/5.00000), 1.0 / 2)*STATES[38]*(STATES[0] - EK);
real EKs =  (( R*T)/( zk*F))*log((ko+ PKNa*nao)/(STATES[5]+ PKNa*STATES[3]));
real KsCa = 1.00000+0.600000/(1.00000+pow(3.80000e-05/STATES[9], 1.40000));
real IKs =  GKs*KsCa*STATES[39]*STATES[40]*(STATES[0] - EKs);
real aK1 = 4.09400/(1.00000+exp( 0.121700*((STATES[0] - EK) - 49.9340)));
real bK1 = ( 15.7200*exp( 0.0674000*((STATES[0] - EK) - 3.25700))+exp( 0.0618000*((STATES[0] - EK) - 594.310)))/(1.00000+exp( - 0.162900*((STATES[0] - EK)+14.2070)));
real K1ss = aK1/(aK1+bK1);
real IK1 =  GK1* pow((ko/5.00000), 1.0 / 2)*K1ss*(STATES[0] - EK);
real Knao =  Knao0*exp(( (1.00000 - delta)*vfrt)/3.00000);
real a3 = ( k3p*pow(ko/Kko, 2.00000))/((pow(1.00000+nao/Knao, 3.00000)+pow(1.00000+ko/Kko, 2.00000)) - 1.00000);
real P = eP/(1.00000+H/Khp+STATES[3]/Knap+STATES[5]/Kxkur);
real b3 = ( k3m*P*H)/(1.00000+MgATP/Kmgatp);
real Knai =  Knai0*exp(( delta*vfrt)/3.00000);
real a1 = ( k1p*pow(STATES[3]/Knai, 3.00000))/((pow(1.00000+STATES[3]/Knai, 3.00000)+pow(1.00000+STATES[5]/Kki, 2.00000)) - 1.00000);
real b2 = ( k2m*pow(nao/Knao, 3.00000))/((pow(1.00000+nao/Knao, 3.00000)+pow(1.00000+ko/Kko, 2.00000)) - 1.00000);
real b4 = ( k4m*pow(STATES[5]/Kki, 2.00000))/((pow(1.00000+STATES[3]/Knai, 3.00000)+pow(1.00000+STATES[5]/Kki, 2.00000)) - 1.00000);
real x1 =  a4*a1*a2+ b2*b4*b3+ a2*b4*b3+ b3*a1*a2;
real x2 =  b2*b1*b4+ a1*a2*a3+ a3*b1*b4+ a2*a3*b4;
real x3 =  a2*a3*a4+ b3*b2*b1+ b2*b1*a4+ a3*a4*b1;
real x4 =  b4*b3*b2+ a3*a4*a1+ b2*a4*a1+ b3*b2*a1;
real E1 = x1/(x1+x2+x3+x4);
real E2 = x2/(x1+x2+x3+x4);
real JnakNa =  3.00000*( E1*a3 -  E2*b3);
real E3 = x3/(x1+x2+x3+x4);
real E4 = x4/(x1+x2+x3+x4);
real JnakK =  2.00000*( E4*b1 -  E3*a1);
real INaK =  Pnak*( zna*JnakNa+ zk*JnakK);
real xkb = 1.00000/(1.00000+exp(- (STATES[0] - 10.8968)/23.9871));
real IKb =  GKb*xkb*(STATES[0] - EK);
real I_katp =  fkatp*gkatp*akik*bkik*(STATES[0] - EK);
//Istim = (VOI>=i_Stim_Start&&VOI<=i_Stim_End&&(VOI - i_Stim_Start) -  floor((VOI - i_Stim_Start)/i_Stim_Period)*i_Stim_Period<=i_Stim_PulseDuration ? i_Stim_Amplitude : 0.00000);
real Istim = calc_I_stim;
real Ii = ( 0.500000*(STATES[3]+STATES[5]+cli+ 4.00000*STATES[9]))/1000.00;
real gamma_ki = exp( - constA*1.00000*( pow(Ii, 1.0 / 2)/(1.00000+ pow(Ii, 1.0 / 2)) -  0.300000*Ii));
real PhiCaK_i = ( 1.00000*vffrt*( gamma_ki*STATES[5]*exp( 1.00000*vfrt) -  gamma_ko*ko))/(exp( 1.00000*vfrt) - 1.00000);
real ICaK_i =  (1.00000 - ICaL_fractionSS)*( (1.00000 - fICaLp)*PCaK*PhiCaK_i*STATES[24]*( f*(1.00000 - STATES[33])+ STATES[29]*fca*STATES[33])+ fICaLp*PCaKp*PhiCaK_i*STATES[24]*( fp*(1.00000 - STATES[33])+ STATES[29]*fcap*STATES[33]));
real JdiffK = (STATES[6] - STATES[5])/tauK;
real gamma_kss = exp( - constA*1.00000*( pow(Iss, 1.0 / 2)/(1.00000+ pow(Iss, 1.0 / 2)) -  0.300000*Iss));
real PhiCaK_ss = ( 1.00000*vffrt*( gamma_kss*STATES[6]*exp( 1.00000*vfrt) -  gamma_ko*ko))/(exp( 1.00000*vfrt) - 1.00000);
real ICaK_ss =  ICaL_fractionSS*( (1.00000 - fICaLp)*PCaK*PhiCaK_ss*STATES[24]*( f*(1.00000 - STATES[32])+ STATES[29]*fca*STATES[32])+ fICaLp*PCaKp*PhiCaK_ss*STATES[24]*( fp*(1.00000 - STATES[32])+ STATES[29]*fcap*STATES[32]));
real ENa =  (( R*T)/( zna*F))*log(nao/STATES[3]);
real fINap = 1.00000/(1.00000+KmCaMK/CaMKa);
real INa =  GNa*(STATES[0] - ENa)*pow(STATES[10], 3.00000)*( (1.00000 - fINap)*STATES[11]*STATES[12]+ fINap*STATES[13]*STATES[14]);
real fINaLp = 1.00000/(1.00000+KmCaMK/CaMKa);
real INaL =  GNaL*(STATES[0] - ENa)*STATES[15]*( (1.00000 - fINaLp)*STATES[16]+ fINaLp*STATES[17]);
real allo_i = 1.00000/(1.00000+pow(KmCaAct/STATES[9], 2.00000));
real hna = exp( qna*vfrt);
real h7_i = 1.00000+ (nao/kna3)*(1.00000+1.00000/hna);
real h8_i = nao/( kna3*hna*h7_i);
real k3pp_i =  h8_i*wnaca;
real h1_i = 1.00000+ (STATES[3]/kna3)*(1.00000+hna);
real h2_i = ( STATES[3]*hna)/( kna3*h1_i);
real k4pp_i =  h2_i*wnaca;
real h4_i = 1.00000+ (STATES[3]/kna1)*(1.00000+STATES[3]/kna2);
real h5_i = ( STATES[3]*STATES[3])/( h4_i*kna1*kna2);
real k7_i =  h5_i*h2_i*wna;
real k8_i =  h8_i*h11_i*wna;
real h9_i = 1.00000/h7_i;
real k3p_i =  h9_i*wca;
real k3_i = k3p_i+k3pp_i;
real hca = exp( qca*vfrt);
real h3_i = 1.00000/h1_i;
real k4p_i = ( h3_i*wca)/hca;
real k4_i = k4p_i+k4pp_i;
real h6_i = 1.00000/h4_i;
real k6_i =  h6_i*STATES[9]*kcaon;
real x1_i =  k2_i*k4_i*(k7_i+k6_i)+ k5_i*k7_i*(k2_i+k3_i);
real x2_i =  k1_i*k7_i*(k4_i+k5_i)+ k4_i*k6_i*(k1_i+k8_i);
real x3_i =  k1_i*k3_i*(k7_i+k6_i)+ k8_i*k6_i*(k2_i+k3_i);
real x4_i =  k2_i*k8_i*(k4_i+k5_i)+ k3_i*k5_i*(k1_i+k8_i);
real E1_i = x1_i/(x1_i+x2_i+x3_i+x4_i);
real E2_i = x2_i/(x1_i+x2_i+x3_i+x4_i);
real E3_i = x3_i/(x1_i+x2_i+x3_i+x4_i);
real E4_i = x4_i/(x1_i+x2_i+x3_i+x4_i);
real JncxNa_i = ( 3.00000*( E4_i*k7_i -  E1_i*k8_i)+ E3_i*k4pp_i) -  E2_i*k3pp_i;
real JncxCa_i =  E2_i*k2_i -  E1_i*k1_i;
real INaCa_i =  (1.00000 - INaCa_fractionSS)*Gncx*allo_i*( zna*JncxNa_i+ zca*JncxCa_i);
real INab = ( PNab*vffrt*( STATES[3]*exp(vfrt) - nao))/(exp(vfrt) - 1.00000);
real gamma_nai = exp( - constA*1.00000*( pow(Ii, 1.0 / 2)/(1.00000+ pow(Ii, 1.0 / 2)) -  0.300000*Ii));
real PhiCaNa_i = ( 1.00000*vffrt*( gamma_nai*STATES[3]*exp( 1.00000*vfrt) -  gamma_nao*nao))/(exp( 1.00000*vfrt) - 1.00000);
real ICaNa_i =  (1.00000 - ICaL_fractionSS)*( (1.00000 - fICaLp)*PCaNa*PhiCaNa_i*STATES[24]*( f*(1.00000 - STATES[33])+ STATES[29]*fca*STATES[33])+ fICaLp*PCaNap*PhiCaNa_i*STATES[24]*( fp*(1.00000 - STATES[33])+ STATES[29]*fcap*STATES[33]));
real JdiffNa = (STATES[4] - STATES[3])/tauNa;
real allo_ss = 1.00000/(1.00000+pow(KmCaAct/STATES[2], 2.00000));
real h7_ss = 1.00000+ (nao/kna3)*(1.00000+1.00000/hna);
real h8_ss = nao/( kna3*hna*h7_ss);
real k3pp_ss =  h8_ss*wnaca;
real h1_ss = 1.00000+ (STATES[4]/kna3)*(1.00000+hna);
real h2_ss = ( STATES[4]*hna)/( kna3*h1_ss);
real k4pp_ss =  h2_ss*wnaca;
real h4_ss = 1.00000+ (STATES[4]/kna1)*(1.00000+STATES[4]/kna2);
real h5_ss = ( STATES[4]*STATES[4])/( h4_ss*kna1*kna2);
real k7_ss =  h5_ss*h2_ss*wna;
real k8_ss =  h8_ss*h11_ss*wna;
real h9_ss = 1.00000/h7_ss;
real k3p_ss =  h9_ss*wca;
real k3_ss = k3p_ss+k3pp_ss;
real h3_ss = 1.00000/h1_ss;
real k4p_ss = ( h3_ss*wca)/hca;
real k4_ss = k4p_ss+k4pp_ss;
real h6_ss = 1.00000/h4_ss;
real k6_ss =  h6_ss*STATES[2]*kcaon;
real x1_ss =  k2_ss*k4_ss*(k7_ss+k6_ss)+ k5_ss*k7_ss*(k2_ss+k3_ss);
real x2_ss =  k1_ss*k7_ss*(k4_ss+k5_ss)+ k4_ss*k6_ss*(k1_ss+k8_ss);
real x3_ss =  k1_ss*k3_ss*(k7_ss+k6_ss)+ k8_ss*k6_ss*(k2_ss+k3_ss);
real x4_ss =  k2_ss*k8_ss*(k4_ss+k5_ss)+ k3_ss*k5_ss*(k1_ss+k8_ss);
real E1_ss = x1_ss/(x1_ss+x2_ss+x3_ss+x4_ss);
real E2_ss = x2_ss/(x1_ss+x2_ss+x3_ss+x4_ss);
real E3_ss = x3_ss/(x1_ss+x2_ss+x3_ss+x4_ss);
real E4_ss = x4_ss/(x1_ss+x2_ss+x3_ss+x4_ss);
real JncxNa_ss = ( 3.00000*( E4_ss*k7_ss -  E1_ss*k8_ss)+ E3_ss*k4pp_ss) -  E2_ss*k3pp_ss;
real JncxCa_ss =  E2_ss*k2_ss -  E1_ss*k1_ss;
real INaCa_ss =  INaCa_fractionSS*Gncx*allo_ss*( zna*JncxNa_ss+ zca*JncxCa_ss);
real gamma_nass = exp( - constA*1.00000*( pow(Iss, 1.0 / 2)/(1.00000+ pow(Iss, 1.0 / 2)) -  0.300000*Iss));
real PhiCaNa_ss = ( 1.00000*vffrt*( gamma_nass*STATES[4]*exp( 1.00000*vfrt) -  gamma_nao*nao))/(exp( 1.00000*vfrt) - 1.00000);
real ICaNa_ss =  ICaL_fractionSS*( (1.00000 - fICaLp)*PCaNa*PhiCaNa_ss*STATES[24]*( f*(1.00000 - STATES[32])+ STATES[29]*fca*STATES[32])+ fICaLp*PCaNap*PhiCaNa_ss*STATES[24]*( fp*(1.00000 - STATES[32])+ STATES[29]*fcap*STATES[32]));
real Jdiff = (STATES[2] - STATES[9])/tauCa;
real fJrelp = 1.00000/(1.00000+KmCaMK/CaMKa);
real Jrel =  Jrel_b*( (1.00000 - fJrelp)*STATES[41]+ fJrelp*STATES[42]);
real Bcass = 1.00000/(1.00000+( BSRmax*KmBSR)/pow(KmBSR+STATES[2], 2.00000)+( BSLmax*KmBSL)/pow(KmBSL+STATES[2], 2.00000));
real gamma_cai = exp( - constA*4.00000*( pow(Ii, 1.0 / 2)/(1.00000+ pow(Ii, 1.0 / 2)) -  0.300000*Ii));
real PhiCaL_i = ( 4.00000*vffrt*( gamma_cai*STATES[9]*exp( 2.00000*vfrt) -  gamma_cao*cao))/(exp( 2.00000*vfrt) - 1.00000);
real ICaL_i =  (1.00000 - ICaL_fractionSS)*( (1.00000 - fICaLp)*PCa*PhiCaL_i*STATES[24]*( f*(1.00000 - STATES[33])+ STATES[29]*fca*STATES[33])+ fICaLp*PCap*PhiCaL_i*STATES[24]*( fp*(1.00000 - STATES[33])+ STATES[29]*fcap*STATES[33]));
real ICaL = ICaL_ss+ICaL_i;
real ICaNa = ICaNa_ss+ICaNa_i;
real ICaK = ICaK_ss+ICaK_i;
real IpCa = ( GpCa*STATES[9])/(KmCap+STATES[9]);
real ICab = ( PCab*4.00000*vffrt*( gamma_cai*STATES[9]*exp( 2.00000*vfrt) -  gamma_cao*cao))/(exp( 2.00000*vfrt) - 1.00000);
real IClCa_junc =  (( Fjunc*GClCa)/(1.00000+KdClCa/STATES[2]))*(STATES[0] - ECl);
real IClCa_sl =  (( (1.00000 - Fjunc)*GClCa)/(1.00000+KdClCa/STATES[9]))*(STATES[0] - ECl);
real IClCa = IClCa_junc+IClCa_sl;
real IClb =  GClb*(STATES[0] - ECl);
real Jupnp = ( upScale*0.00542500*STATES[9])/(STATES[9]+0.000920000);
real Jupp = ( upScale*2.75000*0.00542500*STATES[9])/((STATES[9]+0.000920000) - 0.000170000);
real fJupp = 1.00000/(1.00000+KmCaMK/CaMKa);
real Jleak = ( 0.00488250*STATES[7])/15.0000;
real Jup =  Jup_b*(( (1.00000 - fJupp)*Jupnp+ fJupp*Jupp) - Jleak);
real Bcai = 1.00000/(1.00000+( cmdnmax*kmcmdn)/pow(kmcmdn+STATES[9], 2.00000)+( trpnmax*kmtrpn)/pow(kmtrpn+STATES[9], 2.00000));
real Jtr = (STATES[7] - STATES[8])/60.0000;
real Bcajsr = 1.00000/(1.00000+( csqnmax*kmcsqn)/pow(kmcsqn+STATES[8], 2.00000));

rDY_[0] = - (INa+INaL+Ito+ICaL+ICaNa+ICaK+IKr+IKs+IK1+INaCa_i+INaCa_ss+INaK+INab+IKb+IpCa+ICab+IClCa+IClb+I_katp+Istim);
rDY_[1] =  aCaMK*CaMKb*(CaMKb+STATES[1]) -  bCaMK*STATES[1];
rDY_[2] =  Bcass*((( - (ICaL_ss -  2.00000*INaCa_ss)*Acap)/( 2.00000*F*vss)+( Jrel*vjsr)/vss) - Jdiff);
rDY_[3] = ( - (INa+INaL+ 3.00000*INaCa_i+ICaNa_i+ 3.00000*INaK+INab)*Acap)/( F*vmyo)+( JdiffNa*vss)/vmyo;
rDY_[4] = ( - (ICaNa_ss+ 3.00000*INaCa_ss)*Acap)/( F*vss) - JdiffNa;
rDY_[5] = ( - (((Ito+IKr+IKs+IK1+IKb+I_katp+Istim) -  2.00000*INaK)+ICaK_i)*Acap)/( F*vmyo)+( JdiffK*vss)/vmyo;
rDY_[6] = ( - ICaK_ss*Acap)/( F*vss) - JdiffK;
rDY_[7] = Jup - ( Jtr*vjsr)/vnsr;
rDY_[8] =  Bcajsr*(Jtr - Jrel);
rDY_[9] =  Bcai*((( - ((ICaL_i+IpCa+ICab) -  2.00000*INaCa_i)*Acap)/( 2.00000*F*vmyo) - ( Jup*vnsr)/vmyo)+( Jdiff*vss)/vmyo);
rDY_[10] = (mss - STATES[10])/tm;
rDY_[11] = (hss - STATES[11])/th;
rDY_[12] = (jss - STATES[12])/tj;
rDY_[13] = (hssp - STATES[13])/th;
rDY_[14] = (jss - STATES[14])/tjp;
rDY_[15] = (mLss - STATES[15])/tmL;
rDY_[16] = (hLss - STATES[16])/thL;
rDY_[17] = (hLssp - STATES[17])/thLp;
rDY_[18] = (ass - STATES[18])/ta;
rDY_[19] = (iss - STATES[19])/tiF;
rDY_[20] = (iss - STATES[20])/tiS;
rDY_[21] = (assp - STATES[21])/ta;
rDY_[22] = (iss - STATES[22])/tiFp;
rDY_[23] = (iss - STATES[23])/tiSp;
rDY_[24] = (dss - STATES[24])/td;
rDY_[25] = (fss - STATES[25])/tff;
rDY_[26] = (fss - STATES[26])/tfs;
rDY_[27] = (fcass - STATES[27])/tfcaf;
rDY_[28] = (fcass - STATES[28])/tfcas;
rDY_[29] = (jcass - STATES[29])/tjca;
rDY_[30] = (fss - STATES[30])/tffp;
rDY_[31] = (fcass - STATES[31])/tfcafp;
rDY_[32] =  anca*k2n -  STATES[32]*km2n;
rDY_[33] =  anca_i*k2n -  STATES[33]*km2n;
rDY_[34] = ( alpha_1*STATES[35]+ beta_2*STATES[38]+ beta_ItoC2*STATES[37]) -  (beta_1+alpha_2+alpha_C2ToI)*STATES[34];
rDY_[35] = ( alpha*STATES[36]+ beta_1*STATES[34]) -  (beta+alpha_1)*STATES[35];
rDY_[36] =  beta*STATES[35] -  alpha*STATES[36];
rDY_[37] = ( alpha_C2ToI*STATES[34]+ alpha_i*STATES[38]) -  (beta_ItoC2+beta_i)*STATES[37];
rDY_[38] = ( alpha_2*STATES[34]+ beta_i*STATES[37]) -  (beta_2+alpha_i)*STATES[38];
rDY_[39] = (xs1ss - STATES[39])/txs1;
rDY_[40] = (xs2ss - STATES[40])/txs2;
rDY_[41] = (Jrel_inf - STATES[41])/tau_rel;
rDY_[42] = (Jrel_infp - STATES[42])/tau_relp;
